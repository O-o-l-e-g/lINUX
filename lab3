#/bin/bash

# 1 
# выводит в файл work3.log построчно список всех пользователей в системе в следующем формате: «user NNN has id MM»;
awk -F":" '{ print "user " $1 " has id " $3 }' /etc/passwd > work3.log

# 2
# добавляет в файл work3.log строку, содержащую дату последней смены пароля для пользователя root;
chage -l root | head -1 >> work3.log

# 3
# добавляет в файл work3.log список всех групп в системе (только названия групп) через запятую;
sed 's/:.*//' /etc/group | tr -s '\n' ', ' >> work3.log

# 4
# делает так, чтобы при создании нового пользователя у него в домашнем каталоге создавался файл readme.txt с текстом 
# «Be careful!»;
echo "Be careful!" > /etc/skel/readme.txt

# 5
# создает пользователя u1 с паролем 12345678;
useradd u1 -m
echo "12345678\n12345678" | passwd u1

# 6
# создает группу g1;
groupadd g1

# 7
# делает так, чтобы пользователь u1 дополнительно входил в группу g1;
usermod -aG g1 u1

# 8
# добавляет в файл work3.log строку, содержащую сведения об идентификаторе и имени пользователя u1 
# и идентификаторах и именах всех групп, в которые он входит;
id u1 >> work3.log

# 9
# делает так, чтобы пользователь user дополнительно входил в группу g1
usermod -aG g1 user

# 10
# добавляет в файл work3.log строку с перечнем пользователей в группе g1 через запятую;
cat /etc/group | grep g1 | tr ':' '\n' | tail -n 1

# 11
# делает так, что при входе пользователя u1 в систему вместо оболочки bash автоматически запускается 
# /usr/bin/mc, при выходе из которого пользователь возвращается к вводу логина и пароля;
usermod -s /usr/bin/mc u1

# 12
# создает пользователя u2 с паролем 87654321;
useradd u2 -m
echo "87654321\n87654321" | passwd u2

# 13
# в каталоге /home создает каталог test13, в который копирует файл work3.log два раза с разными именами 
# (work3-1.log и work3-2.log);
mkdir /home/test13
cp work3.log /home/test13/work3-1.log
cp work3.log /home/test13/work3-2.log

# 14
# сделает так, чтобы пользователи u1 и u2 смогли бы просматривать каталог test13 и читать эти файлы, 
# только пользователь u1 смог бы изменять и удалять их, а все остальные пользователи системы не могли 
# просматривать содержимое каталога test13 и файлов в нем. При этом никто не должен иметь права исполнять эти файлы;
groupadd g13
usermod -aG g13 u1
usermod -aG g13 u2
chown u1 /home/test13
chmod -R 640 /home/test13

# 15
# создает в каталоге /home каталог test14, в который любой пользователь системы сможет записать данные, 
# но удалить любой файл сможет только пользователь, который его создал или пользователь u1;
mkdir /home/test14
chown u1 /home/test14
chmod -R 1222 /home/test14


# 16
# копирует в каталог test14 исполняемый файл редактора nano и делает так, чтобы любой 
# пользователь смог изменять с его помощью файлы, созданные в пункте 13;
cp /usr/bin/nano /home/test14/nano
chmod -R a+r /home/test14

# 17
# создает каталог test15 и создает в нем текстовый файл /test15/secret_file. Делает так, чтобы содержимое этого файла 
# можно было вывести на экран, используя полный путь, но чтобы узнать имя этого файла, было бы невозможно.
mkdir /home/test15
echo "secret!" > /home/test15/secret_file
chmod 444 /home/test15
